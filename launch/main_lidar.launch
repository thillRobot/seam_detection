<launch>

  <!-- launch file for processing pointclouds from aubo_control main_LIDAR.launch -->
  <env name="LIBGL_ALWAYS_SOFTWARE" value="1"/>

  <!-- read value of arg for configuration file-->
  <arg name="main_config" default="main_lidar" />
  <param name="param" value="$(arg main_config)"/> 
   
  <!-- load the parameters from config file -->
  <rosparam file="$(find seam_detection)/config/$(arg main_config).yaml" /> 

  <!-- setup the transformations and frames for the system-->
  <node
    pkg="seam_detection"
    name="seam_detection_tf"
    type="seam_detection_tf"
    output="screen">
  </node>
 
  <!-- read value of arg for configuration file-->
  <arg name="save_config" default="save_cloud" />
  <param name="param" value="$(arg save_config)"/> 
   
  <!-- load the parameters from config file -->
  <rosparam file="$(find seam_detection)/config/$(arg save_config).yaml" />
  
  <!-- save the cloud published by the aubo robot arm -->
  <node                     
    pkg="seam_detection"          
    name="save_cloud"   
    type="save_cloud"
    output="screen">  
  </node>

  <!-- read value of arg for configuration file-->
  <arg name="register_config" default="register_clouds" />
  <param name="param" value="$(arg register_config)"/> 
   
  <!-- load the parameters from config file -->
  <rosparam file="$(find seam_detection)/config/$(arg register_config).yaml" />
 
  <!-- processing of lidar data for registration -->
  <node
    pkg="seam_detection"
    name="register_clouds"
    type="register_clouds"
    output="screen">
  </node>

  <!-- start RVIZ --> 
  <node 
    name="rviz"
    pkg="rviz"
    type="rviz"
    args="-d $(find seam_detection)/rviz/register_clouds.rviz">
  </node>

</launch>
